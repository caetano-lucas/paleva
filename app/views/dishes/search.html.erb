<h1><%= I18n.t('dishes.dishes_found')%>: <%= @find %> </h1>
<p><%= link_to I18n.t('dishes.new_dish'), new_restaurant_dish_path %></p>
<%= form_with(url: restaurant_dishes_path(@restaurant), method: :get, local: true) do %>
  <h3><%= I18n.t('.dishes.filter_by_features')%>:</h3>
  
  <% @features.each do |feature| %>
    <div>
      <ul>
        <li><%= label_tag "feature_ids_#{feature.feature.id}", feature.feature.name %>
        <%= check_box_tag "feature_ids[]", feature.feature.id, params[:feature_ids]&.include?(feature.feature.id.to_s) %></li>
      </ul>
    </div>
  <% end %>
  <%= submit_tag I18n.t('.filter') %>
<% end %>

<p><%= link_to I18n.t('dishes.feature_list'), restaurant_features_path %></p>
<% if @dishes.present? %> 

  <table>
    <thead>
    <tr>
        <th><%= Dish.human_attribute_name(:image)%> </th>
        <th><%= Dish.human_attribute_name(:name)%></th>
        <th><%= Dish.human_attribute_name(:description)%></th>
        <th><%= Dish.human_attribute_name(:calories)%></th>
        <th><%= I18n.t('.contains')%></th>
        <th><%= Dish.human_attribute_name(:status)%></th>
        <th><%= I18n.t('.action')%></th>
    </tr>
    </thead>
    <tbody>
      <% @dishes.each do |dish| %>
        <tr>
          <td>
            <% if dish.image.attached? %>
              <%= image_tag dish.image, size: "100x100", alt: dish.name %>
            <% else %>
              <p><%= I18n.t('.no_img')%></p>
            <% end %>
          </td>
          <td> <%= dish.name %> </td>
          <td> <%= dish.description %> </td>
          <td> <%= dish.calories %> </td>
          <td> 
            <% dish.features.each do |dish_feature| %>
              <%= dish_feature.name %>
            <% end %>
          </td>
          <td> <%= I18n.translate(dish.status) %></td>
          <td> <%= link_to "#{I18n.t('.details')} #{dish.name}", restaurant_dish_path(current_user.restaurant, dish) %></td>
          <td> <%= link_to "#{I18n.t('.edit')} #{dish.name}", edit_restaurant_dish_path(current_user.restaurant, dish) %> </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <h1><%= I18n.t('dishes.dishes_no_found')%></h1>
<% end %>

